(function(){var e=function(e,t){if(_.isArray(e))e=e.slice(0),_.isObject(t)||(t={});else{if(!_.isObject(e))throw new Error("A typeahead must be created with either initial models or have its collection specified in an options object");t=e}this.preInitialize.call(this,e,t),Backbone.View.call(this,t),this.postInitialize.call(this)};e.VERSION="0.1.1",e.extend=Backbone.View.extend,e.ItemView=Backbone.View.extend({tagName:"li",events:{click:"selectItem",mouseover:"activateItem"},initialize:function(e){this.parent=e.parent},render:function(){return this.$el.html(_.template(this.template,this.model.toJSON())),this},selectItem:function(){this.parent.selectModel(this.model)},activateItem:function(){this.parent.activateModel(this.model)}}),_.extend(e.prototype,Backbone.View.prototype,{preInitialize:function(t,i){i.key||(i.key="name"),i.limit||(i.limit=8),_.isUndefined(i.collection)&&_.isArray(t)&&(i.collection=new Backbone.Collection(t,i)),this.view=i.view,_.isUndefined(this.view)&&(this.view=e.ItemView.extend({template:i.itemTemplate||"<a><%- "+i.key+" %></a>"})),this.events=_.extend({},this.nativeEvents,_.result(this,"events")),this.options=i},postInitialize:function(){this.results=[],this.focused=!1,this.shown=!1,this.mousedover=!1},template:'<input type="text" class="form-control" placeholder="Search" /><ul class="dropdown-menu"></ul>',nativeEvents:{keyup:"keyup",keypress:"keypress",keydown:"keydown","blur input":"blur","focus input":"focus",mouseenter:"mouseenter",mouseleave:"mouseleave"},render:function(){return this.$el.html(this.template),this.$menu=this.$("ul"),this.$input=this.$("input"),this},rerender:function(e){this.$menu.empty(),_.each(e,this.renderModel,this),e.length?this.show():this.hide()},renderModel:function(e){this.$menu.append(new this.view({model:e,parent:this}).render().el)},search:function(e){var t=new RegExp(e,"i"),i=this.options.key;return this.collection.filter(function(e){return t.test(e.get(i))})},clearInput:function(){this.$input.val("")},searchInput:function(){this.results=this.search(this.$input.val()).slice(0,this.options.limit),this.rerender(this.results)},select:function(){var e=this.$menu.find(".active").index();this.selectModel(this.results[e])},selectModel:function(e){this.$input.val(e.get(this.options.key)),this.hide(),this.trigger("selected",e,this.collection),this.results=[]},activateModel:function(){this.$menu.find(".active").removeClass("active")},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.searchInput()}e.stopPropagation(),e.preventDefault()},focus:function(){this.focused=!0,this.shown||this.show()},blur:function(){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},mouseenter:function(){this.mousedover=!0},mouseleave:function(){this.mousedover=!1,!this.focused&&this.shown&&this.hide()},keydown:function(e){this.suppressKeyPressRepeat=~$.inArray(e.keyCode,[40,38,9,13,27]),this.move(e)},keypress:function(e){this.suppressKeyPressRepeat||this.move(e)},move:function(e){if(this.shown){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prevItem();break;case 40:e.preventDefault(),this.nextItem()}e.stopPropagation()}},prevItem:function(){var e=this.$menu.find(".active").removeClass("active"),t=e.prev();t.length||(t=this.$menu.find("li").last()),t.addClass("active")},nextItem:function(){var e=this.$menu.find(".active").removeClass("active"),t=e.next();t.length||(t=this.$menu.find("li").first()),t.addClass("active")},show:function(){if(this.results.length){var e=$.extend({},this.$input.position(),{height:this.$input[0].offsetHeight});return this.$menu.css({top:e.top+e.height,left:e.left}).show(),this.shown=!0,this}},hide:function(){return this.$menu.hide(),this.shown=!1,this}}),Backbone.Typeahead=e}).call(this);
//# sourceMappingURL=backbone.typeahead.min.js.map